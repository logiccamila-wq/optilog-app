(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4026:function(e,t,n){Promise.resolve().then(n.bind(n,746))},746:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return S},dynamic:function(){return A}});var o=n(7437),i=n(2265),a=n(5511),r=n(3755),l=n(2879),s=n(4962),u=n(4839),d=n(5137),c=n(8023),f=n(7229),h=n(2012),p=n(3819);function m(e){return(0,p.ZP)("MuiCard",e)}(0,h.Z)("MuiCard",["root"]);let g=e=>{let{classes:t}=e;return(0,d.Z)({root:["root"]},m,t)},v=(0,c.ZP)(s.Z,{name:"MuiCard",slot:"Root"})({overflow:"hidden"}),b=i.forwardRef(function(e,t){let n=(0,f.i)({props:e,name:"MuiCard"}),{className:i,raised:a=!1,...r}=n,l={...n,raised:a},s=g(l);return(0,o.jsx)(v,{className:(0,u.Z)(s.root,i),elevation:a?8:void 0,ref:t,ownerState:l,...r})});function _(e){return(0,p.ZP)("MuiCardContent",e)}(0,h.Z)("MuiCardContent",["root"]);let x=e=>{let{classes:t}=e;return(0,d.Z)({root:["root"]},_,t)},C=(0,c.ZP)("div",{name:"MuiCardContent",slot:"Root"})({padding:16,"&:last-child":{paddingBottom:24}}),y=i.forwardRef(function(e,t){let n=(0,f.i)({props:e,name:"MuiCardContent"}),{className:i,component:a="div",...r}=n,l={...n,component:a},s=x(l);return(0,o.jsx)(C,{as:a,className:(0,u.Z)(s.root,i),ownerState:l,ref:t,...r})});var w=n(3555),P=n(8358),Z=n(7138),j=n(8593),I=n(357);let A="force-dynamic";function S(){let[e,t]=(0,i.useState)([]),[n,u]=(0,i.useState)(!0),[d,c]=(0,i.useState)(null),[f,h]=(0,i.useState)(void 0),[p,m]=(0,i.useState)(!1),[g,v]=(0,i.useState)(!1),_=!!I.env.NEXT_PUBLIC_POSTS_API_URL;(0,i.useEffect)(()=>{(async()=>{u(!0);try{let e=await (0,j.T$)(5);t(e),e.length>0&&h(e[e.length-1].slug),e.length<5&&v(!0),c(null)}catch(e){c(e.message||"Erro ao buscar posts")}finally{u(!1)}})()},[]);let x=async()=>{if(!p&&!g){m(!0);try{let e=await (0,j.T$)(5,f);t(t=>[...t,...e]),e.length>0&&h(e[e.length-1].slug),e.length<5&&v(!0)}catch(e){c(e.message||"Erro ao carregar mais posts")}finally{m(!1)}}};return n?(0,o.jsx)("main",{className:"container",children:(0,o.jsx)(a.Z,{children:"Carregando posts..."})}):(0,o.jsxs)("main",{className:"container",children:[(0,o.jsx)(a.Z,{variant:"h4",sx:{mb:1,fontWeight:700},children:"OptiLog"}),(0,o.jsx)(a.Z,{variant:"body2",sx:{mb:2,color:"text.secondary"},children:"Lista de posts. Integra\xe7\xe3o com API externa \xe9 opcional (defina `NEXT_PUBLIC_POSTS_API_URL`)."}),(0,o.jsx)(r.Z,{"aria-live":"polite",children:d&&(0,o.jsxs)(l.Z,{severity:"error",sx:{mb:2},children:["Erro: ",d]})}),!_&&!1,!d&&0===e.length&&(0,o.jsx)(s.Z,{variant:"outlined",sx:{p:2,mb:2},children:(0,o.jsx)(a.Z,{children:"Nenhum post encontrado."})}),!d&&e.map(e=>(0,o.jsx)(b,{variant:"outlined",sx:{mb:2},children:(0,o.jsxs)(y,{children:[(0,o.jsx)(Z.default,{href:"/posts/".concat(e.slug),style:{textDecoration:"none",color:"inherit"},children:(0,o.jsx)(a.Z,{variant:"h6",sx:{fontWeight:600},children:e.title})}),(0,o.jsx)(a.Z,{variant:"body2",sx:{mt:1,color:"text.secondary"},children:e.content}),(0,o.jsx)(r.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2},children:(0,o.jsx)(w.Z,{label:e.is_published?"Publicado":"Rascunho",size:"small",color:e.is_published?"success":"default"})})]})},e.id)),!d&&!g&&(0,o.jsx)(r.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mt:2},children:(0,o.jsx)(P.Z,{variant:"contained",onClick:x,disabled:p,children:p?"Carregando...":"Carregar mais"})})]})}},6353:function(e,t,n){"use strict";n.d(t,{E7:function(){return c},l2:function(){return u},zA:function(){return d}});var o=n(5236);let i="AIzaSyCErAtVhtvFAeA2_-7-AC9-sK-0QXkWUAA",a="studio-4793785332-8ea02.firebaseapp.com",r="studio-4793785332-8ea02",l="1:435822865745:web:51bc089558ac12631ef770",s=!!(i&&a&&r&&l),u=s?(0,o.C6)().length?(0,o.Mq)():(0,o.ZF)({apiKey:i,authDomain:a,projectId:r,storageBucket:"studio-4793785332-8ea02.firebasestorage.app",messagingSenderId:"435822865745",appId:l}):null;async function d(){if(!s||!u)return null;let{getFirestore:e}=await Promise.all([n.e(358),n.e(288)]).then(n.bind(n,9842));return e(u)}async function c(){if(!s||!u)return null;let{getAuth:e}=await Promise.all([n.e(139),n.e(597)]).then(n.bind(n,5735));return e(u)}},8593:function(e,t,n){"use strict";n.d(t,{T$:function(){return l},xl:function(){return r}});var o=n(6353);let i=n(357).env.NEXT_PUBLIC_POSTS_API_URL,a=[{id:"demo-1",slug:"boas-vindas",title:"Boas-vindas ao Optilog!",content:"Esta \xe9 uma postagem de demonstra\xe7\xe3o exibida quando o Firebase n\xe3o est\xe1 configurado.",is_published:!0,author_id:"demo-user"},{id:"demo-2",slug:"como-configurar",title:"Como configurar sua fonte de dados",content:"Defina as vari\xe1veis NEXT_PUBLIC_FIREBASE_* para integrar seu backend Firestore.",is_published:!0,author_id:"demo-user"}];async function r(e){if(i)try{let n=i.replace(/\/$/,""),o=await fetch("".concat(n,"/posts/").concat(encodeURIComponent(e)),{cache:"no-store"});if(o.ok||(o=await fetch("".concat(n,"/posts?slug=").concat(encodeURIComponent(e)),{cache:"no-store"})),o.ok){let n=await o.json(),i=Array.isArray(n)?n[0]:n;if(i){var t,r,l,s,u,d,c,f,h,p;return{id:null!==(r=null!==(t=i.id)&&void 0!==t?t:i._id)&&void 0!==r?r:e,slug:null!==(l=i.slug)&&void 0!==l?l:e,title:null!==(s=i.title)&&void 0!==s?s:"Sem t\xedtulo",content:null!==(d=null!==(u=i.content)&&void 0!==u?u:i.description)&&void 0!==d?d:"",is_published:!!(null===(f=null!==(c=i.is_published)&&void 0!==c?c:i.published)||void 0===f||f),author_id:null!==(p=null!==(h=i.author_id)&&void 0!==h?h:i.authorId)&&void 0!==p?p:null}}}}catch(e){console.warn("Erro ao buscar post na API externa, usando fallback:",e)}let m=await (0,o.zA)();if(m)try{let{collection:t,getDocs:o,query:i,where:a,limit:r}=await Promise.all([n.e(358),n.e(288)]).then(n.bind(n,9842)),l=i(t(m,"posts"),a("slug","==",e),a("is_published","==",!0),r(1)),s=await o(l);if(s.empty)return null;let u=s.docs[0];return{id:u.id,...u.data()}}catch(t){return console.warn("Permiss\xe3o/erro ao buscar post no Firestore, usando demo:",t),a.find(t=>t.slug===e)||null}return a.find(t=>t.slug===e)||null}async function l(e,t){if(i)try{let n=i.replace(/\/$/,""),o="".concat(n,"/posts?limit=").concat(encodeURIComponent(e)).concat(t?"&after=".concat(encodeURIComponent(t)):""),a=await fetch(o,{cache:"no-store"});if(a.ok){let e=await a.json();if(Array.isArray(e))return e.map(e=>{var t,n,o,i,a,r,l,s,u,d,c,f,h;return{id:null!==(o=null!==(n=null!==(t=e.id)&&void 0!==t?t:e._id)&&void 0!==n?n:e.slug)&&void 0!==o?o:Math.random().toString(36).slice(2),slug:null!==(r=e.slug)&&void 0!==r?r:String(null!==(a=null!==(i=e.id)&&void 0!==i?i:e._id)&&void 0!==a?a:""),title:null!==(l=e.title)&&void 0!==l?l:"Sem t\xedtulo",content:null!==(u=null!==(s=e.content)&&void 0!==s?s:e.description)&&void 0!==u?u:"",is_published:!!(null===(c=null!==(d=e.is_published)&&void 0!==d?d:e.published)||void 0===c||c),author_id:null!==(h=null!==(f=e.author_id)&&void 0!==f?f:e.authorId)&&void 0!==h?h:null}})}}catch(e){console.warn("Erro na API externa (pagina\xe7ao), usando fallback:",e)}let r=await (0,o.zA)();if(r)try{let{collection:o,getDocs:i,query:a,where:l,limit:s,orderBy:u,startAfter:d}=await Promise.all([n.e(358),n.e(288)]).then(n.bind(n,9842)),c=t?a(o(r,"posts"),l("is_published","==",!0),u("slug"),d(t),s(e)):a(o(r,"posts"),l("is_published","==",!0),u("slug"),s(e));return(await i(c)).docs.map(e=>({id:e.id,...e.data()}))}catch(i){console.warn("Permiss\xe3o/erro ao paginar Firestore, usando demo:",i);let n=[...a].sort((e,t)=>e.slug.localeCompare(t.slug)),o=0;if(t){let e=n.findIndex(e=>e.slug===t);o=e>=0?e+1:0}return n.slice(o,o+e)}let l=[...a].sort((e,t)=>e.slug.localeCompare(t.slug)),s=0;if(t){let e=l.findIndex(e=>e.slug===t);s=e>=0?e+1:0}return l.slice(s,s+e)}}},function(e){e.O(0,[94,236,771,879,124,138,968,971,23,744],function(){return e(e.s=4026)}),_N_E=e.O()}]);